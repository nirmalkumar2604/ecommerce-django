{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}NK Mart{% endblock %}</title>
  <link rel="stylesheet" href="{% static 'css/style.css' %}" />
  <style>
    /* Ensure footer stays at the bottom */
    html, body {
      height: 100%;
      margin: 0;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    main {
      flex: 1;
      padding: 20px;
    }

    footer {
      margin-top: auto;
      background: #000;
      color: #fff;
      text-align: center;
      padding: 20px 0;
    }

    footer .footer-links a {
      color: #00bfff;
      margin: 0 10px;
      text-decoration: none;
    }
    footer .footer-links a:hover {
      text-decoration: underline;
    }
  </style>
</head>

<body>
  <!-- ===== Navbar ===== -->
  <header class="navbar">
    <div class="logo" onclick="window.location.href='/'">
      üõí <span>NK Mart</span>
    </div>

    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Search for products..." />
      <button onclick="handleSearch()">üîç</button>
    </div>

    <button id="themeToggle" class="theme-toggle">üåô</button>

    <nav class="nav-links">
      <a href="/ui/login/">Login</a>
      <a href="/ui/cart/">Cart</a>
      <a href="/ui/add_product/">Sell</a>
      <div class="dropdown">
        <a href="#">More ‚ñæ</a>
        <div class="dropdown-content">
          <a href="/ui/orders/">My Orders</a>
          <a href="/ui/register/">Register</a>
          <a href="/ui/forget_password/">Forgot Password</a>
        </div>
      </div>
    </nav>
  </header>

  <!-- ===== Main Page Content ===== -->
  <main>
    {% block content %}
    {% endblock %}
  </main>

  <!-- ===== Footer ===== -->
  <footer>
    <div class="footer-content">
      <p>¬© {{ year|default:2025 }} <strong>NK Mart</strong>. All rights reserved.</p>
      <div class="footer-links">
        <a href="#">About</a>
        <a href="#">Privacy Policy</a>
        <a href="#">Contact</a>
      </div>
    </div>
  </footer>

  <!-- ===== Loading Spinner Overlay ===== -->
  <div id="loadingOverlay" class="loading-overlay">
    <div class="spinner"></div>
    <p>Loading...</p>
  </div>

  <!-- ===== Toast Notification Container ===== -->
  <div id="toastContainer" class="toast-container"></div>

  <!-- ===== Back to Top Button ===== -->
  <button id="backToTop" class="back-to-top">‚Üë</button>

  <!-- ===== Theme & Script Section ===== -->
  <script>
    const body = document.body;
    const toggle = document.getElementById("themeToggle");

    // Load saved theme
    if (localStorage.getItem("theme") === "dark") {
      body.classList.add("dark-mode");
      toggle.textContent = "‚òÄÔ∏è";
    }

    // Toggle theme with fade
    toggle.addEventListener("click", () => {
      body.classList.toggle("dark-mode");
      const isDark = body.classList.contains("dark-mode");
      toggle.textContent = isDark ? "‚òÄÔ∏è" : "üåô";
      localStorage.setItem("theme", isDark ? "dark" : "light");
    });

    // Back to Top Button Logic
    const backToTop = document.getElementById("backToTop");
    window.addEventListener("scroll", () => {
      if (window.scrollY > 200) backToTop.classList.add("show");
      else backToTop.classList.remove("show");
    });
    backToTop.addEventListener("click", () => window.scrollTo({ top: 0, behavior: "smooth" }));

    // Toast Notification System
    function showToast(message, type = "info") {
      const container = document.getElementById("toastContainer");
      const toast = document.createElement("div");
      toast.className = `toast ${type}`;
      toast.textContent = message;
      container.appendChild(toast);
      setTimeout(() => toast.classList.add("show"), 100);
      setTimeout(() => { toast.classList.remove("show"); setTimeout(() => toast.remove(), 300); }, 3000);
    }

    // Loading Overlay Functions
    const loader = document.getElementById("loadingOverlay");
    function showLoader() { loader.classList.add("show"); }
    function hideLoader() { loader.classList.remove("show"); }
  </script>
</body>
</html>
